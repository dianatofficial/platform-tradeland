<div class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">
  <!-- Page Header -->
  <app-page-header 
    title="دوره های آموزشی"
    subtitle="دانش خود را با دوره های تخصصی اساتید برتر بازارهای مالی ارتقا دهید.">
  </app-page-header>

  <!-- Filter and Search Bar -->
  <div class="mb-8 space-y-4">
    <!-- Search and Category -->
    <div class="ios-card p-3 flex flex-col md:flex-row gap-3 items-center">
      <div class="relative w-full md:w-80">
        <input 
          type="text" 
          placeholder="جستجوی دوره یا مدرس..." 
          [value]="searchTerm()"
          (input)="onSearch($event)"
          class="w-full pl-10 pr-4 py-3 border-none bg-gray-100 rounded-lg focus:ring-2 focus:ring-blue-500 focus:bg-white transition-all">
        <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none">
          <i data-lucide="search" class="w-5 h-5"></i>
        </span>
      </div>
      <div class="flex items-center gap-2 overflow-x-auto no-scrollbar pb-1 w-full md:w-auto">
         <button (click)="selectCategory('all')"
                [class]="selectedCategory() === 'all' ? 'ios-button-primary' : 'bg-white text-gray-700 hover:bg-gray-100 border'"
                class="ios-button ios-button-sm flex-shrink-0">
          همه دسته ها
        </button>
        @for(cat of categories(); track cat.id) {
          <button (click)="selectCategory(cat.id)"
                  [class]="selectedCategory() === cat.id ? 'ios-button-primary' : 'bg-white text-gray-700 hover:bg-gray-100 border'"
                  class="ios-button ios-button-sm flex-shrink-0">
            {{ cat.name }}
          </button>
        }
      </div>
    </div>
    
    <!-- Level -->
    <div class="flex items-center justify-center gap-x-4 gap-y-2 flex-wrap">
      <span class="text-sm font-semibold text-gray-700">سطح دوره:</span>
      <div class="flex items-center gap-2 flex-wrap">
        <button (click)="onLevelChange('all')"
                [class]="selectedLevel() === 'all' ? 'bg-slate-800 text-white' : 'bg-white text-gray-700 hover:bg-gray-100 border'"
                class="px-4 py-1.5 text-sm font-medium rounded-full transition-all duration-200">
          همه
        </button>
        @for(level of levels(); track level) {
          <button (click)="onLevelChange(level)"
                  [class]="selectedLevel() === level ? 'bg-slate-800 text-white' : 'bg-white text-gray-700 hover:bg-gray-100 border'"
                  class="px-4 py-1.5 text-sm font-medium rounded-full transition-all duration-200">
            {{ level }}
          </button>
        }
      </div>
    </div>
  </div>


  <!-- Content Area -->
  <div class="min-h-[400px]">
    <app-query-state [status]="status()" [error]="error()" (refetch)="refetch()">
      <div slot="loading">
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
          @for (_ of [1,2,3,4,5,6]; track $index) {
            <app-course-card-skeleton></app-course-card-skeleton>
          }
        </div>
      </div>
      
      <!-- Success content in default slot -->
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
        @for (course of filteredCourses(); track course.id) {
          <app-course-card [course]="course"></app-course-card>
        } @empty {
          <div class="sm:col-span-2 lg:col-span-3 text-center py-16">
            <div class="inline-block bg-white p-8 rounded-2xl shadow-sm border">
              <i data-lucide="book-open-off" class="w-16 h-16 text-gray-400 mx-auto"></i>
              <h3 class="mt-4 text-xl font-bold text-gray-800">دوره ای یافت نشد</h3>
              <p class="mt-2 text-gray-600 max-w-sm">متاسفانه هیچ دوره ای با فیلترهای انتخابی شما مطابقت ندارد.</p>
            </div>
          </div>
        }
      </div>
    </app-query-state>
  </div>
</div>
